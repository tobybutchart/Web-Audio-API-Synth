$(window).resize(function(){var a=$("#div-custom-osc1").width();$("#bars-custom-osc1").trigger("configure",{width:a});var a=$("#div-custom-osc2").width();$("#bars-custom-osc2").trigger("configure",{width:a});var a=$("#div-lfo1").width();$("#xy-lfo1").trigger("configure",{width:a})});function setOsc(a,c,b,e){c.frequency.setTargetAtTime(e,audioContext.currentTime,0);if(a==="custom"){var d=[];$(b).each(function(f,g){d.push(parseFloat($(g).val()/1000))});sineTerms=new Float32Array(d);cosineTerms=new Float32Array(sineTerms.length);customWaveform=audioContext.createPeriodicWave(cosineTerms,sineTerms);c.setPeriodicWave(customWaveform)}else{c.type=a}}function startNote(a,b){osc1=audioContext.createOscillator();osc2=audioContext.createOscillator();lfo1=audioContext.createOscillator();setOsc(document.getElementById("osc1Type").value,osc1,"#bars-custom-osc1 :input",b);setOsc(document.getElementById("osc2Type").value,osc2,"#bars-custom-osc2 :input",b);lfo1.frequency.setTargetAtTime(parseFloat($("#lfo1-freq").val()/5),audioContext.currentTime,0);lfo1.type=document.getElementById("lfo1Type").value;createPatching();oscillators[b]=[osc1,osc2,lfo1];osc1.detune.value=document.getElementById("dial-finetune-osc1").value;osc2.detune.value=document.getElementById("dial-finetune-osc2").value;osc1.start(audioContext.currentTime);osc2.start(audioContext.currentTime);lfo1.start(audioContext.currentTime)}function stopNote(a,b){if(oscillators[b]){oscillators[b].forEach(function(c){c.stop(audioContext.currentTime)})}}function setEvents(){$(".effect-dial").knob({release:function(d){var h=this.$[0];var c=parseInt(this.$[0].dataset.effectindex);var g=parseInt(this.$[0].dataset.controlindex);var f=window[effects[c].effectType];f[effects[c].controls[g].controlProperty]=d}});keyboard.keyDown=function(c,d){var e=freqToMidiNote(d);startNote(c,d);playDrumSound(c)};keyboard.keyUp=function(c,d){stopNote(c,d)};$(".dial").dial();$(".bars").bars({width:545,cols:16,min:-100,max:100,fgColor:"#FFF"});$(".xy").xy();var a;var b;$("#randomise-osc1").bind("click",function(){animateOSC1=true;animateBar($(".bar-osc1"),true,a,1)});$("#start-osc1").bind("click",function(){canLoop[1]=true;animateBar($(".bar-osc1"),false,a,1)});$("#stop-osc1").bind("click",function(){canLoop[1]=false});$("#randomise-osc2").bind("click",function(){animateOSC2=true;animateBar($(".bar-osc2"),true,b,2)});$("#start-osc2").bind("click",function(){canLoop[2]=true;animateBar($(".bar-osc2"),false,b,2)});$("#stop-osc2").bind("click",function(){canLoop[2]=false})};